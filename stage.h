#pragma once
#include <Vector2.h>
#include <vector>

class Player;
//class CSV_Loader;

const int kMaxFieldSize_ = 18;
const int kMaxPieceNum = 10;

class Stage
{
	const int kMapchipSize_ = 40;

	std::vector<std::vector<int>>* field_;
	std::vector<std::vector<int>> collision_;
	std::vector<std::vector<std::vector<int>>>* piece_;
	std::vector<Vector2> piecePos_;

	const unsigned int color[kMaxPieceNum] = {
		0xFF5733a0,
		0xA8B820a0,
		0x3D9140a0,
		0x61C4F2a0,
		0xE7F16Fa0,
		0xE52B50a0,
		0x6F2DA8a0,
		0xF28C61a0,
		0x91403Da0,
		0x2B50E7a0
	};

	Vector2 sub_ = { 0,0 };
	int isHave_ = -1;
	int mx_, my_;
	const char* stageFilePath_[64] = {
		"./data/mapchip.csv"
	};

	Player* player_;

	//int field[18][18] = {//描画用配列
	//	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
	//};
	//int collision[18][18] = {//判定用配列
	//	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,
	//	1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
	//};
	//int piece1[7][10] = {
	//	   2,2,2,2,0,0,2,2,2,2,
	//	   2,0,0,2,0,0,2,0,0,2,
	//	   2,0,0,2,2,2,2,0,0,2,
	//	   2,0,0,0,0,0,0,0,0,2,
	//	   2,0,0,0,0,0,0,0,0,2,
	//	   2,0,0,0,0,0,0,0,0,2,
	//	   2,2,2,2,2,2,2,2,2,2
	//};
	//int piece2[5][5] = {
	//	0,3,3,3,3,
	//	0,3,0,0,3,
	//	3,3,0,3,3,
	//	3,0,0,3,0,
	//	3,3,3,3,0
	//};
	//Vector2 piecePos[10] = { 900,0 };//左上基準



	void collisionArrReset();

	void PieceMove();

	void playerCollision();
public:
	Stage();

	void Init(int stageNo);

	void Update(char* keys, char* preKeys);

	void Draw();

};